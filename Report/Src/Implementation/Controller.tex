\subsection{Controller}
This section shows how the controller layer works. 
We illustrate this by giving an example controller, showing what it looks like and what it does.

In \lstref{lst:homeController} part of the Home Controller can be seen. 
It defines an `action' (\texttt{index}), this action is what is interpreted from the request sent by the client. 
For space saving purposes all actions but the \texttt{index} action have been omitted.
The home controller uses two services, \texttt{StationService}, used to retrieve an array of all stations, line 8-9, and \texttt{BookingService}, used to retrieve an array of all active bookings for the currently logged in user, line 11-14. 
This illustrates the general idea behind the separation of the entities (the models) and the services associated with those entities.
The index action of the home controller then uses the information loaded by `including' views, and these views then use this information for displaying the content read from the services.

\begin{minipage}{\textwidth}
\begin{lstlisting}[language=php, label=lst:homeController, caption={Home Controller Class.}]
<?php
class Home extends Controller
{
    public function index()
    {
        $this->title = "Home";
        $currentPage = substr($_SERVER["REQUEST_URI"], 1);
        $stationService = new StationService($this->db);
        $stations = $stationService->readAllStations();

        if (Tools::isLoggedIn()) {
            $bookingService = new BookingService($this->db);
            $activeBookings = $bookingService->getActiveBookings($_SESSION["login_user"]);
        }

        require 'application/views/_templates/header.php';
        require 'application/views/home/index.php';
        require 'application/views/_templates/footer.php';
    }
    // [...]
}
\end{lstlisting}
\end{minipage}

As can be seen on line 16-18 three views are included into the function. Because of the way include works in PHP the included content is in the same scope as the rest of the function, which means we can use the variables declared in the function, inside the included content.

The controllers and their actions can be seen in \appref{app-arch:controller}.

As has been seen, the controllers utilise various views, as such, a description of the views follows hereafter.