\section{Model \& Model Services}
This section will describe the model and model service layer.
It will illustrate this by giving an example model, showing what it looks like and what it does and then illustrating the corresponding service.
It will then provide an overview over the rest of the models, their model services and their functions.
For more detail about Model-View-Controller architecture, see \secref{sec:mvc}.

The Bicycle model can be seen in \lstref{lst:bicycleModel}. Our modification to the original MVC skeleton here is then that instead of using the models to implement behaviour, we use it to model the corresponding database table.

\begin{minipage}{\textwidth}
\begin{lstlisting}[language=php, label=lst:bicycleModel, caption={Bicycle Class}]
<?php
class Bicycle
{
    public $bicycle_id = null;
    public $longitude = null;
    public $latitude = null;

    function __construct($bicycle_id, $latitude, $longitude){
        $this->bicycle_id = $bicycle_id;
        $this->longitude = $longitude;
        $this->latitude = $latitude;
    }
}

?>
\end{lstlisting}
\end{minipage}

The corresponding BicycleService, though very truncated, can be seen in \lstref{lst:bicycleService}. The BicycleService implements CRUD methods for the Bicycle model.

\begin{lstlisting}[language=php, label=lst:bicycleService, caption={BicycleService Class}]
<?php

//create read update delete
class BicycleService implements iService
{
    private $db = null;

    function __construct($database){
        try{
            $this->db = $database;
        }
        catch(Exception $ex){
            exit("Unable to connect to database " . $ex);
        }
    }

    /**
     * Function that creates a new bicycle
     * @return the created object
     */
    public function create($bicycle)
    {
        if(validate($bicycle))
        {
            $stmt = $this->db->prepare("INSERT INTO bicycle(longitude, latitude) VALUES (?,?)");
            $stmt->bind_param("dd", $bicycle->longitude, $bicycle->latitude);
            $stmt->execute();
            $id = $this->db->insert_id;
            $stmt->close();
            return new Bicycle($id, $bicycle->longitude, $bicycle->latitude);\fxwarning{Erstattet nulls med longitude and latitude.}
        }
        else
        {
            return null;
        }
    }
    
    //[...]
}

?>
\end{lstlisting}

The models represent the database tables and the services contain Create, Read, Update, Delete functionality. 
The models and their associated services are as follows:

\begin{itemize}
\item Account \& AccountService -- \textbf{AccountService} also for verifying logins.
\item Bicycle \& BicycleService -- No special functionality.
\item Booking \& BookingService -- \textbf{BookingService} also for getting/deleting bookings for a specific user.
\item Dock \& DockService -- \textbf{DockService} also for determining if a dock is currently holding a bicycle or getting all docks at a station.
\item Station \& StationService -- \textbf{StationService} also for getting counts of available bicycles at stations or for searching for a station.
\end{itemize}

We also provide various helper functionality in \textbf{Tools} and \textbf{ViewHelper}. 
In \textbf{Tools} we provide helper functionality for determining if the user is logged in, for including CSS and JavaScript, and for validating special fields like email addresses.
In \textbf{ViewHelper} we provide helper functionality for printing error or success messages, and printing date components.\fxwarning{Burde disse v√¶re i model laget?}

 The next section will show how they are used in the context of the controller layer.